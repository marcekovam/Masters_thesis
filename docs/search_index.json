[["index.html", "Bayesovské modely aukcií Úvod", " Bayesovské modely aukcií Michaela Marčeková 2023-11-04 Úvod Chapeter 1 link "],["aukčné-dáta.html", "Kapitola 1 Aukčné dáta", " Kapitola 1 Aukčné dáta data Code df &lt;- read.csv(&quot;Xbox 3-day auctions.csv&quot;, header = TRUE, sep = &quot;,&quot;) pander(head(df), style=&#39;rmarkdown&#39;) auctionid bid bidtime bidder bidderrate openbid price 8.213e+09 95 2.927 jake7870 0 95 117.5 8.213e+09 115 2.943 davidbresler2 1 95 117.5 8.213e+09 100 2.951 gladimacowgirl 58 95 117.5 8.213e+09 117.5 2.999 daysrus 10 95 117.5 8.213e+09 2 0.06527 donnie4814 5 1 120 8.213e+09 15.25 0.1232 myreeceyboy 52 1 120 Code pander(colSums(is.na(df)), style=&#39;rmarkdown&#39;) auctionid bid bidtime bidder bidderrate openbid price 0 0 0 0 0 0 0 Code df2 &lt;- data.frame(auctions = length(unique(df$auctionid)), bidders = length(unique(df$bidder)), bids = nrow(df), bids_per_auction = nrow(df)/length(unique(df$auctionid))) pander(df2, style=&#39;rmarkdown&#39;) auctions bidders bids bids_per_auction 35 242 557 15.91 Code plot_bidtime &lt;- ggplot(df, aes(x = bidtime)) + geom_histogram(breaks = seq(0, 3, by = 0.2), color = &quot;black&quot;, fill = blue[1], size = 0.001) + theme_bw() + labs(x = &quot;Čas ponúk [dni]&quot;, y = &quot;Absolútna početnosť&quot;) + theme(legend.position = &quot;none&quot;) plot_bidtime "],["livebids.html", "Kapitola 2 Livebids", " Kapitola 2 Livebids make.livebids code Code #################################################################### ####### ####### ####### Recover the livebids from the Proxybids ####### ####### ####### #################################################################### #################################################################### #### find the bid increment for a given auction price #### #################################################################### ## function bid.incr(price) bid.incr &lt;- function(price) { bidint &lt;- c(0,0.99,4.99,24.99,99.99,249.99,499.99,999.99,2499.99,4999.99) ## interval of prices inc &lt;- c(0.05,0.25,0.5,1,2.5,5,10,25,50,100) ## increments of price for particular interval inc[findInterval(price,bidint)] } ############################################################ ########## make livebids ########### ############################################################ ## function recover.livebids(bids,bidder,openbid,winningbid) ## This function reconstructs the sequence of livebids by ## inputing the raw bids,bidder IDs and opening bid recover.livebids &lt;- function(bids,bidder,openbid,winningbid) { nbid &lt;- length(bids) if (nbid==1) { live &lt;- openbid live } else { if (nbid==2) {live &lt;- numeric(nbid) live[1] &lt;- openbid live[nbid] &lt;- winningbid live} else { live &lt;- numeric(nbid) maxbid &lt;- bids[1] live[1] &lt;- openbid live[nbid] &lt;- winningbid currentprice &lt;- bids[1] maxbidder &lt;- bidder[1] for (i in 2:(nbid-1)) { newbid &lt;- bids[i] newbidder &lt;- bidder[i] if (newbid &gt; maxbid) { if (!(identical(newbidder,maxbidder))) { incr &lt;- bid.incr(maxbid) if (newbid &lt; maxbid+incr) currentprice &lt;- newbid else currentprice &lt;- maxbid+incr maxbid &lt;- newbid maxbidder &lt;- newbidder } else {maxbid &lt;- newbid maxbidder &lt;- maxbidder } } else {if (newbid &lt; maxbid) { incr &lt;- bid.incr(newbid) if (newbid+incr&gt;=maxbid) currentprice &lt;- maxbid else currentprice &lt;- newbid+incr maxbid &lt;- maxbid maxbidder &lt;- maxbidder } else { if (!(identical(newbidder,maxbidder))) {currentprice &lt;- maxbid maxbid &lt;- maxbid maxbidder &lt;- maxbidder } else {currentprice &lt;- currentprice maxbid &lt;- maxbid maxbidder &lt;- maxbidder } } } live[i] &lt;- currentprice } live } } } Code current_price &lt;- list() for (au in unique(df$auctionid)){ current_price[[as.character(au)]] &lt;- recover.livebids(df$bid[which(df$auctionid == au)], df$bidder[which(df$auctionid == au)], unique(df$openbid[which(df$auctionid == au)]), unique(df$price[which(df$auctionid == au)])) } df_current_price &lt;- data.frame( time = df$bidtime, price = unname(unlist(current_price)), auctionid = unname(unlist(sapply(names(current_price), \\(k){rep(k, times = length(current_price[[k]]))}))) ) pander(head(df_current_price), style=&#39;rmarkdown&#39;) time price auctionid 2.927 95 8213034705 2.943 96 8213034705 2.951 102.5 8213034705 2.999 117.5 8213034705 0.06527 1 8213060420 0.1232 2.25 8213060420 Code df_current_price_extend &lt;- df_current_price for (k in unique(df_current_price$auctionid)){ df_current_price_extend &lt;- add_row(df_current_price_extend, time = 0, price = min(df_current_price$price[which(df$auctionid == k)]), auctionid = k, .before = min(which(df_current_price_extend$auctionid == k))) df_current_price_extend &lt;- add_row(df_current_price_extend, time = 3, price = max(df_current_price$price[which(df$auctionid == k)]), auctionid = k, .after = max(which(df_current_price_extend$auctionid == k))) } plot_auction &lt;- ggplot() + geom_step(data = df_current_price_extend[which(df_current_price_extend$auctionid %in% unique(df_current_price_extend$auctionid)[c(4, 5, 11)]), ], aes(x = time, y = price, color = as.factor(auctionid))) + geom_point(data = df[which(df$auctionid %in% unique(df$auctionid)[c(4, 5, 11)]), ], aes(x = bidtime, y = bid, color = as.factor(auctionid)), size = 0.7) + theme_bw() + labs(x = &quot;Čas ponúk [dni]&quot;, y = &quot;Ponuky [USD]&quot;) + theme(legend.position = &quot;none&quot;) + scale_color_manual(values = c(gold, blue[2], olive)) plot_auction Code plot_auction &lt;- ggplot() + geom_step(data = df_current_price_extend, aes(x = time, y = price, color = as.factor(auctionid))) + geom_point(data = df, aes(x = bidtime, y = bid, color = as.factor(auctionid)), size = 0.7) + theme_bw() + labs(x = &quot;Čas ponúk [dni]&quot;, y = &quot;Ponuky [USD]&quot;) + theme(legend.position = &quot;none&quot;) plot_auction "],["transformácia-kosínovej-bázy.html", "Kapitola 3 Transformácia kosínovej bázy", " Kapitola 3 Transformácia kosínovej bázy "],["príklady-gaussovských-procesov.html", "Kapitola 4 Príklady gaussovských procesov 4.1 Section 4.2 Section 4.3 Section", " Kapitola 4 Príklady gaussovských procesov 4.1 Section 4.2 Section 4.2.1 Subsection 4.3 Section "],["vplyv-hyperparametrov.html", "Kapitola 5 Vplyv hyperparametrov", " Kapitola 5 Vplyv hyperparametrov Code set.seed(2) n &lt;- 100 f &lt;- function(x) 5 - 10*x + 5*exp(-100*(x - 0.3)^2) - 5*exp(-100*(x - 0.7)^2) x &lt;- runif(n) w &lt;- rnorm(n, sd = 0.5) y &lt;- 10*w + f(x) + rnorm(n, sd = 2) df_sim &lt;- data.frame(x = x, y = y, w = w, f = f(x)) xx &lt;- seq(0, 1, by = 0.01) df_fun &lt;- data.frame(x = xx, f = f(xx)) p1 &lt;- ggplot() + geom_line(data = df_fun, aes(x = x, y = f), color = blue[2], size = 0.7) + theme_bw() + theme(legend.position = &quot;none&quot;) p2 &lt;- ggplot() + geom_point(data = df_sim, aes(x = x, y = y - 10*w), color = blue[2], size = 0.7) + theme_bw() + theme(legend.position = &quot;none&quot;) p3 &lt;- ggplot() + geom_point(data = df_sim, aes(x = x, y = y), color = blue[2], size = 0.7) + theme_bw() + theme(legend.position = &quot;none&quot;) (p1 | p2 | p3) Obrázok 5.1: Simulované dáta Code mcmc &lt;- list(nblow = 10000, nskip = 10, smcmc = 5000, ndisp = 5000) prior &lt;- list(iflagprior = 0, beta_m0 = c(0, 0), beta_v0 = diag(100, 2), tau2_m0 = 1, tau2_v0 = 100, w0 = 2, sigma2_m0 = 1, sigma2_v0 = 1000) set.seed(2) fout1 &lt;- bsar(y ~ w + fs(x), nbasis = 50, mcmc = mcmc, prior = prior, shape = &quot;Free&quot;, marginal.likelihood = TRUE, spm.adequacy = TRUE) fit1 &lt;- fitted(fout1, HPD = FALSE) p1 &lt;- ggplot() + geom_polygon(aes(x = c(fit1$xgrid, rev(fit1$xgrid)), y = c(fit1$fxgrid$lower, rev(fit1$fxgrid$upper))), fill = gray) + geom_point(aes(x = fit1$x, y = fit1$y - fit1$wbeta$mean), size = 0.6, color = &quot;black&quot;) + geom_line(aes(x = fit1$xgrid, y = fit1$fxgrid$mean), color = red, size = 0.8) + #ylim(c(-10.5, 10.5)) + theme_bw() + labs(x = &quot;Čas [dni]&quot;, y = &quot;Parametrické reziduá&quot;) + theme(axis.title.x = element_text(size = 8, vjust = 0.3), axis.title.y = element_text(size = 8, vjust = 1.6), axis.text.x = element_text(size = 7, color = &quot;black&quot;), axis.text.y = element_text(size = 7, color = &quot;black&quot;), panel.border = element_rect(size = 1, color = &quot;black&quot;), plot.margin = unit(c(2, 2, 2, 2), &quot;pt&quot;), legend.position = &quot;none&quot;) p1 "],["priebeh-aukcií.html", "Kapitola 6 Priebeh aukcií 6.1 Model s vyvolávaciou cenou", " Kapitola 6 Priebeh aukcií 6.1 Model s vyvolávaciou cenou Code df &lt;- data.frame(auctionid = df_current_price$auctionid, livebid = df_current_price$price, bidtime = df_current_price$time, openbid = df$openbid) df &lt;- df |&gt; mutate( day1 = as.numeric(ceiling(df$bidtime) == 1), day2 = as.numeric(ceiling(df$bidtime) == 2), day3 = as.numeric(ceiling(df$bidtime) == 3), ) df &lt;- df |&gt; mutate( day1i = day1*openbid, day2i = day2*openbid, day3i = day3*openbid, ) pander(head(df), style = &quot;rmarkdown&quot;) Table continues below auctionid livebid bidtime openbid day1 day2 day3 day1i 8213034705 95 2.927 95 0 0 1 0 8213034705 96 2.943 95 0 0 1 0 8213034705 102.5 2.951 95 0 0 1 0 8213034705 117.5 2.999 95 0 0 1 0 8213060420 1 0.06527 1 1 0 0 1 8213060420 2.25 0.1232 1 1 0 0 1 day2i day3i 0 95 0 95 0 95 0 95 0 0 0 0 "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
